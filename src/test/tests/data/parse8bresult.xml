<p:declare-step xmlns:xproc="http://xproc.net/xproc" xmlns:ext="http://xproc.net/xproc/ext" xmlns:c="http://www.w3.org/ns/xproc-step" xmlns:err="http://www.w3.org/ns/xproc-error" xmlns:xxq-error="http://xproc.net/xproc/error" xmlns:p="http://www.w3.org/ns/xproc" exclude-inline-prefixes="c cx" name="main" version="1.0" xproc:type="comp-step" xproc:default-name="!1"><ext:pre xproc:default-name="!1.0" xproc:step="true"><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output></ext:pre><p:exec command="/projects/src/calabash/generate-test-report" xproc:type="error"></p:exec><p:string-replace match="uri/text()" name="patch-test-uris" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.1"><p:input xproc:type="comp" port="source" primary="true" select="/"><p:inline xproc:type="comp"> <test-suites>    <uri>/tests/required/test-suite.xml</uri><uri>/tests/serialization/test-suite.xml</uri><uri>/tests/optional/test-suite.xml</uri><uri>/tests/extension/test-suite.xml</uri></test-suites></p:inline></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="match" select="uri/text()"></p:with-option><p:with-option xproc:type="comp" name="replace" select="concat('concat(&quot;http://',$host,'&quot;,.)')"></p:with-option></p:string-replace><p:identity name="extract-uri" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.2"><p:input xproc:type="comp" port="source" sequence="true" primary="true" select="/*/uri"><p:pipe step="patch-test-uris" port="result" xproc:type="comp"></p:pipe></p:input><p:output xproc:type="comp" port="result" sequence="true" primary="true" select="/"></p:output></p:identity><p:choose xproc:step="true" xproc:type="comp-step" xproc:default-name="!1.3"><ext:pre xmlns:ext="http://xproc.net/xproc/ext" xproc:default-name="!1.3.0" xproc:step="true"><p:input xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output><p:xpath-context xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" select="/"><p:empty xproc:type="comp"></p:empty></p:xpath-context></ext:pre><p:when test="$host = 'tests.xproc.org'" xproc:step="true" xproc:type="comp-step" xproc:default-name="!1.3.2"><ext:pre xmlns:ext="http://xproc.net/xproc/ext" xproc:default-name="!1.3.2.0" xproc:step="true"><p:input xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output><p:xpath-context xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" select="/"></p:xpath-context></ext:pre><p:wrap-sequence wrapper="test-suites" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.3.2.2"><p:input xproc:type="comp" port="source" sequence="true" primary="true" select="/"><p:pipe step="extract-uri" port="result" xproc:type="comp"></p:pipe></p:input><p:output xproc:type="comp" port="result" sequence="true" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="wrapper" select="test-suites"></p:with-option><p:with-option xproc:type="comp" name="group-adjacent"></p:with-option></p:wrap-sequence></p:when><p:otherwise xproc:step="true" xproc:type="comp-step" xproc:default-name="!1.3.3"><ext:pre xmlns:ext="http://xproc.net/xproc/ext" xproc:default-name="!1.3.3.0" xproc:step="true"><p:input xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output><p:xpath-context xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" select="/"></p:xpath-context></ext:pre><p:wrap-sequence wrapper="test-suites" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.3.3.1"><p:input xproc:type="comp" port="source" sequence="true" primary="true" select="/"><p:pipe step="extract-uri" port="result" xproc:type="comp"></p:pipe><p:inline xproc:type="comp"> <uri>http://localhost:8130/tests/test-suite.xml</uri></p:inline></p:input><p:output xproc:type="comp" port="result" sequence="true" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="wrapper" select="test-suites"></p:with-option><p:with-option xproc:type="comp" name="group-adjacent"></p:with-option></p:wrap-sequence></p:otherwise></p:choose><p:choose xproc:step="true" xproc:type="comp-step" xproc:default-name="!1.4"><ext:pre xmlns:ext="http://xproc.net/xproc/ext" xproc:default-name="!1.4.0" xproc:step="true"><p:input xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output><p:xpath-context xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" select="/"></p:xpath-context></ext:pre><p:when test="$password = ''" xproc:step="true" xproc:type="comp-step" xproc:default-name="!1.4.1"><ext:pre xmlns:ext="http://xproc.net/xproc/ext" xproc:default-name="!1.4.1.0" xproc:step="true"><p:input xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output><p:xpath-context xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" select="/"></p:xpath-context></ext:pre><p:identity xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.1.2"><p:input xproc:type="comp" port="source" sequence="true" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" sequence="true" primary="true" select="/"></p:output></p:identity></p:when><p:otherwise xproc:step="true" xproc:type="comp-step" xproc:default-name="!1.4.2"><ext:pre xmlns:ext="http://xproc.net/xproc/ext" xproc:default-name="!1.4.2.0" xproc:step="true"><p:input xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" port="result" primary="true" select="/"></p:output><p:xpath-context xmlns:p="http://www.w3.org/ns/xproc" xproc:type="comp" select="/"></p:xpath-context></ext:pre><p:wrap wrapper="c:body" match="/" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.1"><p:input xproc:type="comp" port="source" primary="true" select="/c:result/*"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="wrapper" select="c:body"></p:with-option><p:with-option xproc:type="comp" name="match" select="/"></p:with-option><p:with-option xproc:type="comp" name="group-adjacent"></p:with-option></p:wrap><p:add-attribute match="c:body" attribute-name="content-type" attribute-value="application/xml" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.2"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="match" select="c:body"></p:with-option><p:with-option xproc:type="comp" name="attribute-name" select="content-type"></p:with-option><p:with-option xproc:type="comp" name="attribute-prefix"></p:with-option><p:with-option xproc:type="comp" name="attribute-namespace"></p:with-option><p:with-option xproc:type="comp" name="attribute-value" select="application/xml"></p:with-option></p:add-attribute><p:wrap wrapper="c:request" match="/" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.3"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="wrapper" select="c:request"></p:with-option><p:with-option xproc:type="comp" name="match" select="/"></p:with-option><p:with-option xproc:type="comp" name="group-adjacent"></p:with-option></p:wrap><p:add-attribute attribute-name="password" match="/c:request" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.4"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="match" select="/c:request"></p:with-option><p:with-option xproc:type="comp" name="attribute-name" select="password"></p:with-option><p:with-option xproc:type="comp" name="attribute-prefix"></p:with-option><p:with-option xproc:type="comp" name="attribute-namespace"></p:with-option><p:with-option xproc:type="comp" name="attribute-value" select="$password"></p:with-option></p:add-attribute><p:add-attribute attribute-name="username" match="/c:request" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.5"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="match" select="/c:request"></p:with-option><p:with-option xproc:type="comp" name="attribute-name" select="username"></p:with-option><p:with-option xproc:type="comp" name="attribute-prefix"></p:with-option><p:with-option xproc:type="comp" name="attribute-namespace"></p:with-option><p:with-option xproc:type="comp" name="attribute-value" select="$username"></p:with-option></p:add-attribute><p:add-attribute attribute-name="href" match="/c:request" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.6"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="match" select="/c:request"></p:with-option><p:with-option xproc:type="comp" name="attribute-name" select="href"></p:with-option><p:with-option xproc:type="comp" name="attribute-prefix"></p:with-option><p:with-option xproc:type="comp" name="attribute-namespace"></p:with-option><p:with-option xproc:type="comp" name="attribute-value" select="concat('http://',$host,'/results/submit/report')"></p:with-option></p:add-attribute><p:set-attributes match="c:request" xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.7"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:input xproc:type="comp" port="attributes" primary="false" select="/"><p:inline xproc:type="comp"> <c:request xmlns:c="http://www.w3.org/ns/xproc-step" method="post" auth-method="Basic" send-authorization="true"></c:request></p:inline></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="match" select="c:request"></p:with-option></p:set-attributes><p:http-request xproc:step="true" xproc:type="std-step" xproc:default-name="!1.4.2.8"><p:input xproc:type="comp" port="source" primary="true" select="/"></p:input><p:output xproc:type="comp" port="result" primary="true" select="/"></p:output><p:with-option xproc:type="comp" name="byte-order-mark"></p:with-option><p:with-option xproc:type="comp" name="cdata-section-elements"></p:with-option><p:with-option xproc:type="comp" name="doctype-public"></p:with-option><p:with-option xproc:type="comp" name="doctype-system"></p:with-option><p:with-option xproc:type="comp" name="encoding"></p:with-option><p:with-option xproc:type="comp" name="escape-uri-attributes"></p:with-option><p:with-option xproc:type="comp" name="include-content-type"></p:with-option><p:with-option xproc:type="comp" name="indent" select="'false'"></p:with-option><p:with-option xproc:type="comp" name="media-type"></p:with-option><p:with-option xproc:type="comp" name="method" select="'xml'"></p:with-option><p:with-option xproc:type="comp" name="normalization-form"></p:with-option><p:with-option xproc:type="comp" name="omit-xml-declaration"></p:with-option><p:with-option xproc:type="comp" name="standalone"></p:with-option><p:with-option xproc:type="comp" name="undeclare-prefixes"></p:with-option><p:with-option xproc:type="comp" name="version" select="'1.0'"></p:with-option></p:http-request></p:otherwise></p:choose></p:declare-step>
