<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml"><head><style>
             .good {background-color: #3F0;}
             .bad {background-color:#F30;}
         </style></head><body><div class="container"><h1>xprocxq main module</h1><p><b>67% Tests ran successfully</b><br/>:</p><table summary="This is the summary text for this table." border="1" cellpadding="0" cellspacing="0"><thead><tr><th>test name</th><th>status</th><th>result</th><th>expected</th></tr></thead><tbody><tr xmlns=""><td><b>xproc1</b><br/>xproc module load</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc1a</b><br/>test entry point</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc1b</b><br/>test entry point via HOX invoke</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc2a</b><br/>test explicit naming parsing</td><td><div class="bad">failed </div></td><td><textarea name="content" rows="6" cols="60">false<p:declare-step xmlns:xproc="http://xproc.net/xproc" xmlns:p="http://www.w3.org/ns/xproc" version="1.0" xproc:type="comp-step">
<p:input port="source" xproc:type="comp">
  <p:inline xproc:type="comp"><doc>
Congratulations! You've run your first pipeline!
</doc></p:inline>
</p:input>
<p:output port="result" xproc:type="comp"/>

<p:identity xproc:step="true" xproc:type="std-step"/>
</p:declare-step></textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc2b</b><br/>test explicit naming parsing</td><td><div class="bad">failed </div></td><td><textarea name="content" rows="6" cols="60">false<p:declare-step xmlns:xproc="http://xproc.net/xproc" xmlns:p="http://www.w3.org/ns/xproc" version="1.0" xproc:type="comp-step">
<p:input port="source" xproc:type="comp">
  <p:inline xproc:type="comp"><doc>
Congratulations! You've run your first pipeline!
</doc></p:inline>
</p:input>
<p:output port="result" xproc:type="comp"/>

<p:identity xproc:step="true" xproc:type="std-step"/>
</p:declare-step></textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc2c</b><br/>test explicit naming parsing</td><td><div class="bad">failed </div></td><td><textarea name="content" rows="6" cols="60">false<p:declare-step xmlns:xproc="http://xproc.net/xproc" xmlns:p="http://www.w3.org/ns/xproc" exclude-inline-prefixes="c cx" name="main" version="1.0" xproc:type="comp-step">
<p:output port="result" xproc:type="comp"/>
<p:option name="host" select="'tests.xproc.org'" xproc:type="comp"/>
<p:option name="username" select="'calabash'" xproc:type="comp"/>
<p:option name="password" select="''" xproc:type="comp"/>

<p:documentation xproc:type="comp">
<div xmlns="http://www.w3.org/1999/xhtml">
  <p>This pipeline runs the XProc test suite and reports the results.</p>
  <p>It has three options: <code>host</code>, <code>username</code>, and
  <code>password</code>.</p>
  <p>The <code>host</code> option is used to specify the host to use
  in the URIs of test suite documents. (Because Norm has a local copy of
  <a href="http://tests.xproc.org/">http://tests.xproc.org/</a>.)</p>
  <p>The <code>username</code> and <code>password</code> are used to submit
  the test results to <a href="http://tests.xproc.org/">http://tests.xproc.org</a>.
  If run without a password, it simply outputs the report document.</p>
</div>
</p:documentation>

<p:string-replace match="uri/text()" name="patch-test-uris" xproc:step="true" xproc:type="std-step">
  <p:input port="source" xproc:type="comp">
    <p:inline xproc:type="comp">
      <test-suites>
	<uri>/tests/required/test-suite.xml</uri>
	<uri>/tests/serialization/test-suite.xml</uri>
	<uri>/tests/optional/test-suite.xml</uri>
	<uri>/tests/extension/test-suite.xml</uri>
      </test-suites>
    </p:inline>
  </p:input>
  <p:with-option name="replace" select="concat('concat(&#34;http://',$host,'&#34;,.)')" xproc:type="comp">
    <p:empty xproc:type="comp"/>
  </p:with-option>
</p:string-replace>

<p:identity name="extract-uri" xproc:step="true" xproc:type="std-step">
  <p:input port="source" select="/*/uri" xproc:type="comp">
    <p:pipe step="patch-test-uris" port="result" xproc:type="comp"/>
  </p:input>
</p:identity>

<p:choose xproc:step="true" xproc:type="comp-step">
  <p:xpath-context xproc:type="comp">
    <p:empty xproc:type="comp"/>
  </p:xpath-context>
  <p:when test="$host = 'tests.xproc.org'" xproc:step="true" xproc:type="comp-step">
    <p:wrap-sequence wrapper="test-suites" xproc:step="true" xproc:type="std-step">
      <p:input port="source" xproc:type="comp">
	<p:pipe step="extract-uri" port="result" xproc:type="comp"/>
	
      </p:input>
    </p:wrap-sequence>
  </p:when>
  <p:otherwise xproc:step="true" xproc:type="comp-step">
    <p:wrap-sequence wrapper="test-suites" xproc:step="true" xproc:type="std-step">
      <p:input port="source" xproc:type="comp">
	<p:pipe step="extract-uri" port="result" xproc:type="comp"/>
	<p:inline xproc:type="comp">
	  <uri>http://localhost:8130/tests/test-suite.xml</uri>
	</p:inline>
      </p:input>
    </p:wrap-sequence>
  </p:otherwise>
</p:choose>

<p:exec command="/projects/src/calabash/generate-test-report" xproc:step="true" xproc:type="opt-step">
  <p:input port="source" xproc:type="comp">
    <p:empty xproc:type="comp"/>
  </p:input>
  <p:with-option name="args" select="string-join(//uri,' ')" xproc:type="comp"/>
</p:exec>

<p:choose xproc:step="true" xproc:type="comp-step">
  <p:when test="$password = ''" xproc:step="true" xproc:type="comp-step">
    <p:identity xproc:step="true" xproc:type="std-step"/>
  </p:when>
  <p:otherwise xproc:step="true" xproc:type="comp-step">
    <p:wrap wrapper="c:body" match="/" xproc:step="true" xproc:type="std-step">
      <p:input port="source" select="/c:result/*" xproc:type="comp"/>
    </p:wrap>

    <p:add-attribute match="c:body" attribute-name="content-type" attribute-value="application/xml" xproc:step="true" xproc:type="std-step"/>

    <p:wrap wrapper="c:request" match="/" xproc:step="true" xproc:type="std-step"/>

    <p:add-attribute attribute-name="password" match="/c:request" xproc:step="true" xproc:type="std-step">
      <p:with-option name="attribute-value" select="$password" xproc:type="comp"/>
    </p:add-attribute>

    <p:add-attribute attribute-name="username" match="/c:request" xproc:step="true" xproc:type="std-step">
      <p:with-option name="attribute-value" select="$username" xproc:type="comp"/>
    </p:add-attribute>

    <p:add-attribute attribute-name="href" match="/c:request" xproc:step="true" xproc:type="std-step">
      <p:with-option name="attribute-value" select="concat('http://',$host,'/results/submit/report')" xproc:type="comp"/>
    </p:add-attribute>

    <p:set-attributes match="c:request" xproc:step="true" xproc:type="std-step">
      <p:input port="attributes" xproc:type="comp">
	<p:inline xproc:type="comp">
	  <c:request xmlns:c="http://www.w3.org/ns/xproc-step" method="post" auth-method="Basic" send-authorization="true"/>
	</p:inline>
      </p:input>
    </p:set-attributes>

    <p:http-request xproc:step="true" xproc:type="std-step"/>
  </p:otherwise>
</p:choose>

</p:declare-step></textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc3a</b><br/>test explicit naming parsing adds xproc: namespace</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc3b</b><br/>test explicit naming parsing adds p: namespace</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc4a</b><br/>test parse:type returns correct type</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc4b</b><br/>test parse:type returns correct type</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc4c</b><br/>test parse:type returns correct type</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc4d</b><br/>test parse:type returns correct type</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc5</b><br/>test parse:type returns correct type</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc6</b><br/>test parse:type returns correct error type</td><td><div class="good">passed </div></td><td><textarea name="content" rows="6" cols="60">true error</textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr><tr xmlns=""><td><b>xproc7</b><br/>test parse:explicit-name</td><td><div class="bad">failed </div></td><td><textarea name="content" rows="6" cols="60">false<p:declare-step xmlns:p="http://www.w3.org/ns/xproc" xmlns:xproc="http://xproc.net/xproc" exclude-inline-prefixes="c cx" name="main" version="1.0" xproc:type="comp-step" xproc:default-name="!1"><p:output port="result" xproc:type="comp"/><p:option name="host" select="'tests.xproc.org'" xproc:type="comp"/><p:option name="username" select="'calabash'" xproc:type="comp"/><p:option name="password" select="''" xproc:type="comp"/><p:documentation xproc:type="comp"/><p:string-replace match="uri/text()" name="patch-test-uris" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.1"><p:input port="source" xproc:type="comp"><p:inline xproc:type="comp"/></p:input><p:with-option name="replace" select="concat('concat(&#34;http://',$host,'&#34;,.)')" xproc:type="comp"><p:empty xproc:type="comp"/></p:with-option></p:string-replace><p:identity name="extract-uri" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.2"><p:input port="source" select="/*/uri" xproc:type="comp"><p:pipe step="patch-test-uris" port="result" xproc:type="comp"/></p:input></p:identity><p:choose xproc:step="true" xproc:type="comp-step" xproc:defaultname="!1.3"><p:xpath-context xproc:type="comp"><p:empty xproc:type="comp"/></p:xpath-context><p:when test="$host = 'tests.xproc.org'" xproc:step="true" xproc:type="comp-step" xproc:defaultname="!1.3.1"><p:wrap-sequence wrapper="test-suites" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.3.1.1"><p:input port="source" xproc:type="comp"><p:pipe step="extract-uri" port="result" xproc:type="comp"/></p:input></p:wrap-sequence></p:when><p:otherwise xproc:step="true" xproc:type="comp-step" xproc:defaultname="!1.3.2"><p:wrap-sequence wrapper="test-suites" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.3.2.1"><p:input port="source" xproc:type="comp"><p:pipe step="extract-uri" port="result" xproc:type="comp"/><p:inline xproc:type="comp"/></p:input></p:wrap-sequence></p:otherwise></p:choose><p:exec command="/projects/src/calabash/generate-test-report" xproc:step="true" xproc:type="opt-step" xproc:defaultname="!1.4"><p:input port="source" xproc:type="comp"><p:empty xproc:type="comp"/></p:input><p:with-option name="args" select="string-join(//uri,' ')" xproc:type="comp"/></p:exec><p:choose xproc:step="true" xproc:type="comp-step" xproc:defaultname="!1.5"><p:when test="$password = ''" xproc:step="true" xproc:type="comp-step" xproc:defaultname="!1.5.1"><p:identity xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.1.1"/></p:when><p:otherwise xproc:step="true" xproc:type="comp-step" xproc:defaultname="!1.5.2"><p:wrap wrapper="c:body" match="/" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.1"><p:input port="source" select="/c:result/*" xproc:type="comp"/></p:wrap><p:add-attribute match="c:body" attribute-name="content-type" attribute-value="application/xml" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.2"/><p:wrap wrapper="c:request" match="/" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.3"/><p:add-attribute attribute-name="password" match="/c:request" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.4"><p:with-option name="attribute-value" select="$password" xproc:type="comp"/></p:add-attribute><p:add-attribute attribute-name="username" match="/c:request" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.5"><p:with-option name="attribute-value" select="$username" xproc:type="comp"/></p:add-attribute><p:add-attribute attribute-name="href" match="/c:request" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.6"><p:with-option name="attribute-value" select="concat('http://',$host,'/results/submit/report')" xproc:type="comp"/></p:add-attribute><p:set-attributes match="c:request" xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.7"><p:input port="attributes" xproc:type="comp"><p:inline xproc:type="comp"/></p:input></p:set-attributes><p:http-request xproc:step="true" xproc:type="std-step" xproc:defaultname="!1.5.2.8"/></p:otherwise></p:choose></p:declare-step></textarea></td><td><textarea name="content" rows="6" cols="60">true</textarea></td></tr></tbody></table>

failed: 5 /  success: 10 / total: 15<hr/><p style="text-align:right"><i>2011-05-08T19:28:04.617+02:00</i></p></div></body></html>